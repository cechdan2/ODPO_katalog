@model PhotoApp.Models.PhotoRecord
@{
    ViewData["Title"] = "Veřejný detail vzorku";
}


<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<meta name="theme-color" content="#16a34a">
<link rel="manifest" href="/manifest.json">
<!-- Android / Chrome -->
<meta name="mobile-web-app-capable" content="yes">
<!-- iOS -->
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
<link rel="apple-touch-icon" href="/icons/icon-192.png">


<style>
    /* můžete zkopírovat CSS z hlavního Details view, aby to mělo stejný vzhled */
    :root {
        --brand: #16a34a;
        --brand-dark: #166534;
        --border: #dbe7d9;
        --bg: #f4fbf4;
        --text: #0b1f0b;
        --white: #fff;
        --radius: 12px;
    }

    body {
        font-family: system-ui,-apple-system,Segoe UI,Roboto,Ubuntu;
        color: var(--text);
        background: var(--bg);
    }

    .detail-card {
        background: #fff;
        border: 1px solid var(--border);
        border-radius: var(--radius);
        padding: 2.5rem 2rem;
        margin: 45px auto;
        max-width: 540px;
        box-shadow: 0 2px 8px rgba(0,0,0,.08);
        display: flex;
        flex-direction: column;
        align-items: center;
        text-align: center;
    }

    .detail-img {
        width: 240px;
        height: 240px;
        object-fit: cover;
        border-radius: 14px;
        border: 1.5px solid var(--border);
        margin-bottom: 1.4rem;
        background: #e6f9e9;
        cursor: pointer;
        transition: transform .15s ease;
    }

        .detail-img:hover {
            transform: scale(1.03);
        }

    .detail-title {
        font-size: 2rem;
        color: var(--brand-dark);
        font-weight: 700;
        margin-bottom: 0.6rem;
    }

    .detail-info {
        margin-bottom: 1.2rem;
        color: #444;
    }

    /* zvýrazněné popisky */
    .label {
        font-weight: 700;
        text-transform: uppercase;
        color: var(--brand);
        margin-bottom: 4px;
    }

    .pill {
        display: inline-block;
        padding: 2px 9px;
        border-radius: 999px;
        background: #e6f9e9;
        border: 1px solid var(--border);
        font-size: 15px;
        margin: 0 3px;
    }

    .muted {
        color: #666;
        font-size: 1rem;
        margin-top: 1.3em;
    }

    .btn {
        padding: 8px 16px;
        border-radius: 8px;
        border: 1px solid var(--border);
        background: var(--white);
        color: var(--brand-dark);
        cursor: pointer;
        font-weight: 500;
        margin-top: 2em;
        text-decoration: none;
    }

        .btn:hover {
            background: #e6f9e9;
        }

    /* Lightbox / modal styles */
    .img-overlay {
        position: fixed;
        inset: 0;
        background: rgba(0,0,0,0.75);
        display: none;
        align-items: center;
        justify-content: center;
        z-index: 1200;
        padding: 20px;
    }

        .img-overlay.open {
            display: flex;
        }

        .img-overlay img {
            max-width: 95%;
            max-height: 95%;
            border-radius: 8px;
            box-shadow: 0 6px 30px rgba(0,0,0,0.6);
        }

        .img-overlay .close-btn {
            position: absolute;
            top: 18px;
            right: 18px;
            background: rgba(255,255,255,0.9);
            border: 0;
            border-radius: 6px;
            padding: 6px 10px;
            font-weight: 700;
            cursor: pointer;
            color: #111;
        }

        .img-overlay .caption {
            position: absolute;
            bottom: 26px;
            left: 26px;
            right: 26px;
            text-align: center;
            color: #fff;
            font-size: 14px;
            opacity: 0.95;
        }

    @@media (max-width: 600px) {
        .detail-card

    {
        margin: 18px;
        padding: 1.5rem;
    }

    .detail-img {
        width: 180px;
        height: 180px;
    }

    }
</style>

<header>
    <div class="container" style="display:flex;align-items:center;justify-content:center;gap:12px;flex-direction:column;text-align:center;">
        <div class="page-header" style="display:flex;align-items:center;gap:12px;flex-direction:column;text-align:center;">
            <img src="@Url.Content("~/logo.png")" alt="ODPO logo" style="height:48px;width:auto;display:block;" />
            <div>
                <h1 style="margin:0;font-size:18px;color:var(--brand);">Detail vzorku</h1>
                <div class="muted" style="font-size:13px;">ODPO s.r.o. – Katalog vzorků plastů</div>
            </div>
        </div>
    </div>
</header>

<div class="detail-card">
    @if (!string.IsNullOrEmpty(Model.ImagePath ?? Model.PhotoPath))
    {
        <img id="sampleImage" src="@Url.Content(Model.ImagePath ?? Model.PhotoPath)" class="detail-img" alt="Foto vzorku" aria-describedby="imgCaption" />
    }
    <div class="detail-title">@Model.Name</div>
    <div class="detail-info">
        <div class="field full">
            <div class="label">Název</div>
            <div class="value">@Model.OriginalName</div>
        </div>
        <div class="field">
            <div class="label">Plnivo</div>
            <div class="value">@Model.Filler</div>
        </div>
        <div class="field">
            <div class="label">Barva</div>
            <div class="value">@Model.Color</div>
        </div>
        <div class="field">
            <div class="label">Forma</div>
            <div class="value">@Model.Form</div>
        </div>
        <div class="field">
            <div class="label">Množství (měsíc)</div>
            <div class="value">@Model.MonthlyQuantity</div>
        </div>
        <div class="field">
            <div class="label">MFI</div>
            <div class="value">@Model.Mfi</div>
        </div>
        <div class="field full">
            <div class="label">Poznámky</div>
            <div class="value">@Model.Notes</div>
        </div>
    </div>
</div>

<!-- Lightbox overlay -->
<div id="imgOverlay" class="img-overlay" role="dialog" aria-modal="true" aria-hidden="true">
    <button type="button" class="close-btn" id="closeOverlay" aria-label="Zavřít náhled">✕</button>
    <img id="overlayImage" src="" alt="Rozšířený náhled vzorku" />
    <div id="imgCaption" class="caption">@Model.Name</div>
</div>

<script>
    (function () {
        var img = document.getElementById('sampleImage');
        var overlay = document.getElementById('imgOverlay');
        var overlayImg = document.getElementById('overlayImage');
        var closeBtn = document.getElementById('closeOverlay');

        if (!img || !overlay || !overlayImg || !closeBtn) return;

        // Open overlay when clicking the thumbnail
        img.addEventListener('click', function () {
            overlayImg.src = img.src;
            overlay.classList.add('open');
            overlay.setAttribute('aria-hidden', 'false');
            // trap focus on close button for simple accessibility
            closeBtn.focus();
        });

        // Close actions
        function closeOverlay() {
            overlay.classList.remove('open');
            overlay.setAttribute('aria-hidden', 'true');
            overlayImg.src = '';
            // return focus to thumbnail
            img.focus();
        }

        closeBtn.addEventListener('click', closeOverlay);

        // Close when clicking the background (not the image)
        overlay.addEventListener('click', function (e) {
            if (e.target === overlay || e.target === overlayImg.parentNode) {
                closeOverlay();
            }
        });

        // Close on Escape
        document.addEventListener('keydown', function (e) {
            if (e.key === 'Escape' && overlay.classList.contains('open')) {
                closeOverlay();
            }
        });

        // Make thumbnail keyboard-focusable
        img.setAttribute('tabindex', '0');
        img.addEventListener('keydown', function (e) {
            if (e.key === 'Enter' || e.key === ' ') {
                e.preventDefault();
                img.click();
            }
        });
    })();
</script>